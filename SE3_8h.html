<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuaternionICP: ICP/SE3.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">QuaternionICP
   </div>
   <div id="projectbrief">Multi-view point cloud registration using ray-projected ICP</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SE3_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">SE3.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>SE(3) Lie group utilities for manifold Gauss-Newton optimization.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;array&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;<a class="el" href="EigenTypes_8h_source.html">ICP/EigenTypes.h</a>&gt;</code><br />
</div>
<p><a href="SE3_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceICP" id="r_namespaceICP"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html">ICP</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a16b7297a68b502b0141c5e7798bfa65e" id="r_a16b7297a68b502b0141c5e7798bfa65e"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a16b7297a68b502b0141c5e7798bfa65e">ICP::Tangent6</a> = <a class="el" href="namespaceICP.html#a66f1a56336ae372f3f9a927ba65f5928">Vector6</a></td></tr>
<tr class="memdesc:a16b7297a68b502b0141c5e7798bfa65e"><td class="mdescLeft">&#160;</td><td class="mdescRight">[Vso3]  <br /></td></tr>
<tr class="separator:a16b7297a68b502b0141c5e7798bfa65e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a362e871f42402fcbf60d4b2fa14723b3" id="r_a362e871f42402fcbf60d4b2fa14723b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#adac72b7a83e8527700e3ef4678a4534b">Matrix3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a362e871f42402fcbf60d4b2fa14723b3">ICP::skew</a> (const <a class="el" href="namespaceICP.html#ae0d90165be08ccb0384b3b57094fdc09">Vector3</a> &amp;w)</td></tr>
<tr class="memdesc:a362e871f42402fcbf60d4b2fa14723b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the skew-symmetric matrix from a 3D vector.  <br /></td></tr>
<tr class="separator:a362e871f42402fcbf60d4b2fa14723b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b6b21bf8a08bf3394b0150700304f58" id="r_a2b6b21bf8a08bf3394b0150700304f58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#aba1e60055bc2116056f0c0a2076683a7">Quaternion</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a2b6b21bf8a08bf3394b0150700304f58">ICP::quatExpSO3</a> (const <a class="el" href="namespaceICP.html#ae0d90165be08ccb0384b3b57094fdc09">Vector3</a> &amp;w)</td></tr>
<tr class="memdesc:a2b6b21bf8a08bf3394b0150700304f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">SO(3) exponential map in quaternion form.  <br /></td></tr>
<tr class="separator:a2b6b21bf8a08bf3394b0150700304f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b3732fc4a84e1815c71cbb68afef37d" id="r_a4b3732fc4a84e1815c71cbb68afef37d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#adac72b7a83e8527700e3ef4678a4534b">Matrix3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a4b3732fc4a84e1815c71cbb68afef37d">ICP::Vso3</a> (const <a class="el" href="namespaceICP.html#ae0d90165be08ccb0384b3b57094fdc09">Vector3</a> &amp;w)</td></tr>
<tr class="memdesc:a4b3732fc4a84e1815c71cbb68afef37d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Left Jacobian of SO(3).  <br /></td></tr>
<tr class="separator:a4b3732fc4a84e1815c71cbb68afef37d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215e97af338b930a99f47ee2fa8324d1" id="r_a215e97af338b930a99f47ee2fa8324d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a215e97af338b930a99f47ee2fa8324d1">ICP::se3Plus</a> (const <a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a> &amp;x, const <a class="el" href="namespaceICP.html#a16b7297a68b502b0141c5e7798bfa65e">Tangent6</a> &amp;delta)</td></tr>
<tr class="memdesc:a215e97af338b930a99f47ee2fa8324d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">SE(3) Plus operation using right-multiplication (body-frame perturbation).  <br /></td></tr>
<tr class="separator:a215e97af338b930a99f47ee2fa8324d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8865d90c7b6f090f82426dea3ffe31bd" id="r_a8865d90c7b6f090f82426dea3ffe31bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a877c516427c44ff39f1502406d44e306">Matrix7x6</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a8865d90c7b6f090f82426dea3ffe31bd">ICP::plusJacobian7x6</a> (const <a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a> &amp;x)</td></tr>
<tr class="memdesc:a8865d90c7b6f090f82426dea3ffe31bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">SE(3) chart Jacobian P(x) for the right-multiplicative Plus operation.  <br /></td></tr>
<tr class="separator:a8865d90c7b6f090f82426dea3ffe31bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c70067a8bdeb764403d21ec14dade9" id="r_a79c70067a8bdeb764403d21ec14dade9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a79c70067a8bdeb764403d21ec14dade9">ICP::se3PlusScaled</a> (const <a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a> &amp;x, const <a class="el" href="namespaceICP.html#a16b7297a68b502b0141c5e7798bfa65e">Tangent6</a> &amp;delta, double rotationScale)</td></tr>
<tr class="memdesc:a79c70067a8bdeb764403d21ec14dade9"><td class="mdescLeft">&#160;</td><td class="mdescRight">SE(3) Plus operation with rotation scaling for conditioning.  <br /></td></tr>
<tr class="separator:a79c70067a8bdeb764403d21ec14dade9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ea7110a0a416f488174f4a163041e2" id="r_a01ea7110a0a416f488174f4a163041e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a877c516427c44ff39f1502406d44e306">Matrix7x6</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a01ea7110a0a416f488174f4a163041e2">ICP::plusJacobian7x6Scaled</a> (const <a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a> &amp;x, double rotationScale)</td></tr>
<tr class="memdesc:a01ea7110a0a416f488174f4a163041e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">SE(3) chart Jacobian with rotation scaling for conditioning.  <br /></td></tr>
<tr class="separator:a01ea7110a0a416f488174f4a163041e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a309cff063287a2e1545e90772412982e" id="r_a309cff063287a2e1545e90772412982e"><td class="memItemLeft" align="right" valign="top">Eigen::Matrix&lt; double, 1, 6 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a309cff063287a2e1545e90772412982e">ICP::jacobian7Dto6D</a> (const double *J7, const double *x)</td></tr>
<tr class="memdesc:a309cff063287a2e1545e90772412982e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Project 7D ambient Jacobian to 6D local (tangent space) Jacobian.  <br /></td></tr>
<tr class="separator:a309cff063287a2e1545e90772412982e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71d2cdd1d648aecf54b730104466eb1" id="r_ab71d2cdd1d648aecf54b730104466eb1"><td class="memItemLeft" align="right" valign="top">std::array&lt; <a class="el" href="namespaceICP.html#adac72b7a83e8527700e3ef4678a4534b">Matrix3</a>, 4 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#ab71d2cdd1d648aecf54b730104466eb1">ICP::dR_dq_mats</a> (const <a class="el" href="namespaceICP.html#aba1e60055bc2116056f0c0a2076683a7">Quaternion</a> &amp;q)</td></tr>
<tr class="memdesc:ab71d2cdd1d648aecf54b730104466eb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivatives of rotation matrix R w.r.t. quaternion components.  <br /></td></tr>
<tr class="separator:ab71d2cdd1d648aecf54b730104466eb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbec5581196c73bcaa5a52ef768a470a" id="r_acbec5581196c73bcaa5a52ef768a470a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a5afcbaef6db2661d754bf9fec1bf09ca">Matrix3x4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#acbec5581196c73bcaa5a52ef768a470a">ICP::dRv_dq</a> (const <a class="el" href="namespaceICP.html#aba1e60055bc2116056f0c0a2076683a7">Quaternion</a> &amp;q, const <a class="el" href="namespaceICP.html#ae0d90165be08ccb0384b3b57094fdc09">Vector3</a> &amp;v)</td></tr>
<tr class="memdesc:acbec5581196c73bcaa5a52ef768a470a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of R(q) * v w.r.t. quaternion q.  <br /></td></tr>
<tr class="separator:acbec5581196c73bcaa5a52ef768a470a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21da7e17faf478c372a7a2e3b7747308" id="r_a21da7e17faf478c372a7a2e3b7747308"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceICP.html#a5afcbaef6db2661d754bf9fec1bf09ca">Matrix3x4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a21da7e17faf478c372a7a2e3b7747308">ICP::dRTv_dq</a> (const <a class="el" href="namespaceICP.html#aba1e60055bc2116056f0c0a2076683a7">Quaternion</a> &amp;q, const <a class="el" href="namespaceICP.html#ae0d90165be08ccb0384b3b57094fdc09">Vector3</a> &amp;v)</td></tr>
<tr class="memdesc:a21da7e17faf478c372a7a2e3b7747308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derivative of R(q)^T * v w.r.t. quaternion q.  <br /></td></tr>
<tr class="separator:a21da7e17faf478c372a7a2e3b7747308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e782b81ca69fb5854cc90e6edd7166" id="r_ad0e782b81ca69fb5854cc90e6edd7166"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#ad0e782b81ca69fb5854cc90e6edd7166">ICP::poseToString</a> (const <a class="el" href="namespaceICP.html#a6a3079fb0addad5c502ef87fb05c9d60">Pose7</a> &amp;pose)</td></tr>
<tr class="memdesc:ad0e782b81ca69fb5854cc90e6edd7166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a Pose7 as a human-readable string.  <br /></td></tr>
<tr class="separator:ad0e782b81ca69fb5854cc90e6edd7166"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5e5668583923d4902ff32f74f74d4ba9" id="r_a5e5668583923d4902ff32f74f74d4ba9"><td class="memItemLeft" align="right" valign="top">constexpr double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceICP.html#a5e5668583923d4902ff32f74f74d4ba9">ICP::kSmallAngleThreshold</a> = 1e-12</td></tr>
<tr class="memdesc:a5e5668583923d4902ff32f74f74d4ba9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Small angle threshold for Taylor expansion in SO(3)/SE(3) operations.  <br /></td></tr>
<tr class="separator:a5e5668583923d4902ff32f74f74d4ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SE(3) Lie group utilities for manifold Gauss-Newton optimization. </p>
<p>This header provides the mathematical foundations for SE(3) (Special Euclidean group) operations used in point cloud registration. The implementation follows the <b>right-multiplicative</b> (body-frame) convention for tangent space updates.</p>
<h1><a class="anchor" id="se3_conventions"></a>
Conventions</h1>
<ul>
<li>Eigen::Quaterniond::coeffs() returns [x,y,z,w]</li>
<li>We store poses as [qx, qy, qz, qw]</li>
<li>We construct quaternions as Quaternion(w, x, y, z) (scalar-first)</li>
<li>SE(3) pose: 7D vector <code>[qx, qy, qz, qw, tx, ty, tz]</code></li>
<li>Tangent space: 6D vector <code>[v_x, v_y, v_z, w_x, w_y, w_z]</code> (translation, rotation)</li>
</ul>
<h1><a class="anchor" id="se3_groups"></a>
Lie Groups</h1>
<h2><a class="anchor" id="se3_so3"></a>
SO(3): Special Orthogonal Group</h2>
<p>SO(3) is the group of 3D rotations:  </p><p class="formulaDsp">
\[
  \mathrm{SO}(3) = \{ R \in \mathbb{R}^{3 \times 3} : R^\top R = I, \det(R) = 1 \}
\]
</p>
<h2><a class="anchor" id="se3_se3"></a>
SE(3): Special Euclidean Group</h2>
<p>SE(3) is the group of rigid body transformations:  </p><p class="formulaDsp">
\[
  \mathrm{SE}(3) = \left\{ T = \begin{bmatrix} R &amp; \mathbf{t} \\ \mathbf{0}^\top &amp; 1
  \end{bmatrix} : R \in \mathrm{SO}(3), \mathbf{t} \in \mathbb{R}^3 \right\}
\]
</p>
<h1><a class="anchor" id="se3_skew"></a>
Skew-Symmetric Matrix (Hat Operator)</h1>
<p>The hat operator \([\cdot]_\times : \mathbb{R}^3 \to \mathfrak{so}(3)\) creates a skew-symmetric matrix encoding the cross product:  </p><p class="formulaDsp">
\[
  [\mathbf{w}]_\times = \begin{bmatrix}
    0 &amp; -w_z &amp; w_y \\
    w_z &amp; 0 &amp; -w_x \\
    -w_y &amp; w_x &amp; 0
  \end{bmatrix}
\]
</p>
<h1><a class="anchor" id="se3_expso3"></a>
SO(3) Exponential Map (Quaternion Form)</h1>
<p>The unit quaternion corresponding to \(\exp([\boldsymbol{\phi}]_\times)\) is:  </p><p class="formulaDsp">
\[
  \mathbf{q} = \begin{bmatrix} \cos(\theta/2) \\ \sin(\theta/2) \hat{\mathbf{a}} \end{bmatrix}
\]
</p>
<p>where \(\theta = \|\boldsymbol{\phi}\|\) and \(\hat{\mathbf{a}} = \boldsymbol{\phi}/\theta\).</p>
<h1><a class="anchor" id="se3_leftjac"></a>
Left Jacobian of SO(3)</h1>
<p>The left Jacobian \(V\) couples rotation and translation in SE(3):  </p><p class="formulaDsp">
\[
  V = I + \frac{1 - \cos\theta}{\theta^2}[\boldsymbol{\phi}]_\times
        + \frac{\theta - \sin\theta}{\theta^3}[\boldsymbol{\phi}]_\times^2
\]
</p>
<h1><a class="anchor" id="se3_update"></a>
Right-Multiplicative Update (Body Frame)</h1>
<p>Pose updates use <b>right multiplication</b>:  </p><p class="formulaDsp">
\[
  T \leftarrow T \cdot \exp(\widehat{\delta\boldsymbol{\xi}})
\]
</p>
<p>For a tangent vector \(\boldsymbol{\xi} = (\mathbf{v}, \boldsymbol{\omega})\):  </p><p class="formulaDsp">
\[
  R \leftarrow R \cdot \Delta R, \quad
  \mathbf{t} \leftarrow \mathbf{t} + R \cdot V \cdot \mathbf{v}
\]
</p>
<h1><a class="anchor" id="se3_manifold"></a>
Ambient 7D Storage vs. 6D Manifold Update</h1>
<p>The pose is stored in a 7D <b>ambient</b> parameter vector:  </p><p class="formulaDsp">
\[
  \mathbf{p} = [q_x, q_y, q_z, q_w, t_x, t_y, t_z] \in \mathbb{R}^7,
\]
</p>
<p> where \(\mathbf{q}\) is a <b>unit</b> quaternion and \(\mathbf{t}\) is translation.</p>
<p>Optimization, however, is performed on the SE(3) manifold using a 6D tangent increment (twist) in the Lie algebra \(\mathfrak{se}(3)\):  </p><p class="formulaDsp">
\[
  \delta\boldsymbol{\xi} = (\mathbf{v}, \boldsymbol{\omega})
  = [v_x, v_y, v_z, \omega_x, \omega_y, \omega_z] \in \mathbb{R}^6.
\]
</p>
<p>The mapping from a tangent increment to an SE(3) perturbation uses the exponential map:  </p><p class="formulaDsp">
\[
  \Delta T = \exp(\widehat{\delta\boldsymbol{\xi}})
  = \begin{bmatrix} \Delta R &amp; \Delta\mathbf{t} \\ \mathbf{0}^\top &amp; 1 \end{bmatrix}.
\]
</p>
<p>With the <b>right-multiplicative (body-frame)</b> convention, the state update is:  </p><p class="formulaDsp">
\[
  T \leftarrow T \cdot \Delta T.
\]
</p>
<p>Writing \(T = (R,\mathbf{t})\) and \(\Delta T = (\Delta R, V\,\mathbf{v})\), the update becomes:  </p><p class="formulaDsp">
\[
  R \leftarrow R\,\Delta R, \qquad
  \mathbf{t} \leftarrow \mathbf{t} + R\,V\,\mathbf{v}.
\]
</p>
<p>In quaternion form this is:  </p><p class="formulaDsp">
\[
  \mathbf{q} \leftarrow \mathbf{q} \otimes \delta\mathbf{q}, \qquad
  \mathbf{t} \leftarrow \mathbf{t} + R(\mathbf{q})\,V\,\mathbf{v},
\]
</p>
<p> where \(\delta\mathbf{q} = \exp(\boldsymbol{\omega})\) is the unit quaternion corresponding to \(\Delta R = \exp([\boldsymbol{\omega}]_\times)\).</p>
<h2><a class="anchor" id="se3_manifold_notes"></a>
Practical notes</h2>
<ul>
<li>The quaternion must remain unit-length; implementations typically renormalize \(\mathbf{q}\) after applying \(\delta\mathbf{q}\).</li>
<li>For small \(\|\boldsymbol{\omega}\|\), use series expansions for \(\sin(\theta)/\theta\), \((1-\cos\theta)/\theta^2\), etc., to avoid numerical issues, and to ensure \(V \approx I\) as \(\theta \to 0\).</li>
<li>Because this is a <b>body-frame</b> increment, \(\delta\boldsymbol{\xi}\) is interpreted in the moving frame attached to the current pose.</li>
</ul>
<h1><a class="anchor" id="se3_chart_jac"></a>
Chart Jacobian for Pulling Back Ambient Jacobians</h1>
<p>Many residual/Jacobian implementations compute derivatives w.r.t. the 7D ambient parameters (q,t). Gauss-Newton, however, solves in the 6D tangent space.</p>
<p>Define the Plus chart: x_plus(delta) = Plus(x, delta). The chart Jacobian at the expansion point is: P(x) = ∂ Plus(x,delta) / ∂ delta |_{delta=0} (size 7×6).</p>
<p>Given an ambient Jacobian J7 = ∂r/∂x (size 1×7), the corresponding local Jacobian is: J6 = ∂r/∂delta = J7 * P(x) (size 1×6).</p>
<p>Note: P(x) here is evaluated at delta=0, so terms like ∂t/∂w vanish at the expansion point (they are proportional to v, and v=0 at delta=0). </p>

<p class="definition">Definition in file <a class="el" href="SE3_8h_source.html">SE3.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_742a85a471429c2dbeb367f41e5986a1.html">ICP</a></li><li class="navelem"><a class="el" href="SE3_8h.html">SE3.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
